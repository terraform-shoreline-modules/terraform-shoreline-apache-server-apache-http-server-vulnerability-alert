{
  "name": "apache_http_server_vulnerability_alert",
  "description": "This incident type refers to the detection of vulnerabilities in the Apache HTTP Server. The Apache HTTP Server is a widely used web server application that serves web content to clients. A vulnerability in the server can potentially be exploited by attackers to gain unauthorized access to the server or the data it hosts. This incident type involves the detection of such vulnerabilities and the generation of an alert to prompt action to mitigate the risk associated with the vulnerability.",
  "params": [
    {
      "name": "PACKAGE_NAME",
      "value": ""
    },
    {
      "name": "CONFIGURATION_FILE_PATH",
      "value": ""
    },
    {
      "name": "LATEST_APACHE_HTTP_SERVER_VERSION",
      "value": ""
    },
    {
      "name": "HOST_NAME",
      "value": ""
    },
    {
      "name": "K8S_CLUSTER_NAME",
      "value": ""
    },
    {
      "name": "NAMESPACE",
      "value": ""
    }
  ],
  "cells": [
    {
      "name": "cell_1",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Apache HTTP Server Vulnerability Alert.\nThis incident type refers to the detection of vulnerabilities in the Apache HTTP Server. The Apache HTTP Server is a widely used web server application that serves web content to clients. A vulnerability in the server can potentially be exploited by attackers to gain unauthorized access to the server or the data it hosts. This incident type involves the detection of such vulnerabilities and the generation of an alert to prompt action to mitigate the risk associated with the vulnerability."
    },
    {
      "name": "cell_2",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check Apache HTTP Server version"
    },
    {
      "name": "cell_3",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `httpd -v`"
    },
    {
      "name": "cell_4",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check for any suspicious activities on the server"
    },
    {
      "name": "cell_5",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `tail -f /var/log/secure`"
    },
    {
      "name": "cell_6",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check if Apache HTTP Server is running"
    },
    {
      "name": "cell_7",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `systemctl status httpd`"
    },
    {
      "name": "cell_8",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check Apache HTTP Server logs for any errors"
    },
    {
      "name": "cell_9",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `journalctl -u httpd -b`"
    },
    {
      "name": "cell_10",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check for any recently installed packages that may have caused the vulnerability"
    },
    {
      "name": "cell_11",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `yum history list | grep ${PACKAGE_NAME}`"
    },
    {
      "name": "cell_12",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check for any security updates available for Apache HTTP Server"
    },
    {
      "name": "cell_13",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `yum check-update httpd`"
    },
    {
      "name": "cell_14",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check Apache HTTP Server configuration file for any misconfigurations"
    },
    {
      "name": "cell_15",
      "type": "OP_LANG",
      "enabled": true,
      "content": "(host | host_name=$HOST_NAME) union (pod | k8s_cluster_name=$K8S_CLUSTER_NAME | namespace=$NAMESPACE) | `httpd -t -f ${CONFIGURATION_FILE_PATH}`"
    },
    {
      "name": "cell_16",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Update Apache HTTP Server to the latest version that addresses the vulnerability."
    },
    {
      "name": "cell_17",
      "type": "OP_LANG",
      "enabled": true,
      "content": "host | host_name=$HOST_NAME | invoke_update_apache_version($LATEST_APACHE_HTTP_SERVER_VERSION)"
    }
  ]
}